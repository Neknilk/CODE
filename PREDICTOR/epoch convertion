import pandas as pd

# Read the CSV file into a DataFrame
file_path = r'C:\Users\jayva\Documents\GitHub\FOE\DATA\FILTERED\combined_file_with_flight_number.csv'
df = pd.read_csv(file_path, low_memory=False)

# Convert the 'timestamp' column to epoch time and create a new 'epoch_time' column
df['epoch_time'] = (pd.to_datetime(df['timestamp'], format='%Y-%m-%d %H:%M:%S')
                    .astype('int64') // 10**9)

# Delete the 'numeric_timestamp' column
if 'numeric_timestamp' in df.columns:
    df = df.drop('numeric_timestamp', axis=1)

# Save the updated DataFrame to the original CSV file, overwriting it
df.to_csv(file_path, index=False)
