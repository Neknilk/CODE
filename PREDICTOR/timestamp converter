import os
import pandas as pd
from datetime import datetime

# Function to convert timestamp to numeric format
def convert_to_timestamp(date_time_str):
    date_time_obj = datetime.strptime(date_time_str, "%Y-%m-%d %H:%M:%S")
    return int(date_time_obj.timestamp())

# Folder containing CSV files
folder_path =  r'C:\Users\jayva\Documents\GitHub\FOE\DATA\FILTERED\\'

# List all CSV files in the folder
csv_files = [file for file in os.listdir(folder_path) if file.endswith('.csv')]

# Loop through each CSV file
for csv_file in csv_files:
    # Construct the full path to the CSV file
    file_path = os.path.join(folder_path, csv_file)

    # Read CSV file into a pandas DataFrame
    df = pd.read_csv(file_path)

    # Add a new column with converted timestamps
    df['numeric_timestamp'] = df['timestamp'].apply(convert_to_timestamp)

    # Save the updated DataFrame back to the CSV file
    df.to_csv(file_path, index=False)